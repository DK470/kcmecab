<!doctype html>
<html>
    <head>
        <script type="module">
            import Mecab from "https://unpkg.com/mecab-wasm@1.0.3/lib/mecab.js";

            // Initialize Mecab
            async function initializeMecab() {
                try {
                    await Mecab.waitReady(); // Wait until Mecab is ready
                    console.log("MeCab is ready.");
                } catch (error) {
                    console.error("Error initializing MeCab:", error);
                    alert("Failed to initialize MeCab.");
                }
            }

            // Query handler to send text and get results
            async function handleQuery(inputText) {
                if (inputText) {
                    try {
                        const result = await Mecab.query(inputText); // Query Mecab
                        console.log("MeCab query result:", result);
                        document.body.innerHTML = JSON.stringify(result); // Display result on the page
                    } catch (error) {
                        console.error("Error querying MeCab:", error);
                        document.body.innerHTML = "Error querying MeCab: " + error.message;
                    }
                } else {
                    document.body.innerHTML = JSON.stringify({ error: "No text provided" });
                }
            }

            // Event listener to trigger Mecab query when page is loaded
            window.addEventListener("load", async () => {
                await initializeMecab(); // Ensure MeCab is initialized first
                const params = new URLSearchParams(window.location.search);
                const inputText = params.get("text");
                handleQuery(inputText); // Handle query with the provided text parameter
            });
        </script>
    </head>
    <body>
        <!-- Your content here -->
    </body>
</html>
